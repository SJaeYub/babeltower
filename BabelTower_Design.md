# Babel Tower - 핵앤슬래시 RPG 게임 설계 문서

## 📋 게임 개요

**장르:** 2D 핵앤슬래시 액션 RPG  
**스타일:** 픽셀 아트, 디아블로 스타일 쿼터뷰  
**핵심 루프:** 던전 파밍 → 장비 강화 → 바벨탑 도전 → 기록 갱신

---

## 🎯 핵심 게임플레이 루프

```
[마을] → [던전 입장] → [몬스터 사냥 5-10분] → [아이템 획득] → [마을 귀환]
   ↓                                                                    ↓
[바벨탑]                                                          [대장간/상점]
   ↓                                                                    ↓
[기록 도전] ←←←←←←←←←←←←←←←←←←←←←←←←←←←← [장비 강화/구매]
```

---

## 🏛️ 게임 구조

### 1. 씬(Scene) 구조

```
📁 Scenes/
├── 🏘️ TownScene (마을)
│   ├── 대장간
│   ├── 상점
│   ├── 던전 입구
│   └── 바벨탑 입구
│
├── ⚔️ DungeonScene (던전)
│   ├── 랜덤 맵 생성
│   ├── 랜덤 몬스터 스폰
│   └── 5-10분 타이머
│
└── 🗼 BabelTowerScene (바벨탑)
    ├── 층별 도전
    ├── 보스/무리 전투
    └── 시간 제한
```

### 2. 캐릭터 클래스

| 직업 | 특징 | 주 스탯 | 스킬 컨셉 |
|------|------|---------|-----------|
| **전사** | 근접 탱커 | HP, 방어력 | 돌진, 회전베기, 방패막기, 전쟁의함성 |
| **마법사** | 원거리 딜러 | 마나, 마법공격력 | 파이어볼, 프로즌오브, 라이트닝, 메테오 |
| **도적** | 기습 암살자 | 치명타, 회피율 | 백스탭, 연막탄, 독살, 그림자은신 |
| **궁수** | 원거리 물리딜러 | 공격속도, 사거리 | 관통사격, 멀티샷, 폭발화살, 저격 |

### 3. 아이템 등급 시스템

```
Common (일반) - 회색 테두리 - 드랍률: 70%
Rare (희귀) - 파란 테두리 - 드랍률: 25%
Epic (영웅) - 보라 테두리 - 드랍률: 4%
Legendary (전설) - 주황 테두리 - 드랍률: 1%
```

### 4. 장비 슬롯

```
[무기] [투구] [갑옷]
[장갑] [반지] [부츠]
```

---

## 🗺️ 던전 시스템 설계

### 던전 생성 알고리즘

```
1. 시작 방 생성
2. BSP(Binary Space Partitioning) 또는 Random Walk로 방 배치
3. 복도로 방 연결
4. 몬스터 스폰 포인트 배치 (방당 3-7마리)
5. 아이템 상자 배치 (전체 2-5개)
6. 출구 포탈 배치
```

### 던전 난이도

| 난이도 | 몬스터 레벨 | 보상 배율 |
|--------|-------------|-----------|
| Easy | 1-5 | 1.0x |
| Normal | 6-15 | 1.5x |
| Hard | 16-30 | 2.0x |
| Hell | 31-50 | 3.0x |

### 던전 완료 조건

- 시간: 5-10분 자유 사냥
- 출구 포탈을 통해 자유롭게 탈출 가능
- 클리어 보상: 골드 + 경험치 보너스

---

## 🗼 바벨탑 시스템 설계

### 타워 구조

```
각 층마다:
- 제한시간: 기본 3분 (층이 올라갈수록 -10초씩 감소, 최소 1분)
- 클리어 조건: 모든 적 처치
- 실패 조건: 시간 초과 또는 사망
```

### 층별 난이도 증가

```python
# 층별 몬스터 스탯 공식
monster_hp = base_hp * (1 + floor * 0.15)
monster_attack = base_attack * (1 + floor * 0.12)
monster_count = 3 + (floor // 5)  # 5층마다 1마리씩 증가

# 보스층 (5의 배수)
if floor % 5 == 0:
    spawn_unique_boss()
    time_limit = 5분
```

### 층별 패턴

| 층 | 패턴 | 제한시간 |
|----|------|----------|
| 1-4층 | 일반 몬스터 무리 | 3분 |
| 5층 | 보스 1 | 5분 |
| 6-9층 | 강화 몬스터 무리 | 2분 50초 |
| 10층 | 보스 2 | 5분 |
| ... | ... | ... |

### 보상 시스템

```
- 층 클리어: 골드 + 경험치
- 5층마다 (보스): 보장된 Rare 이상 아이템
- 10층마다: Epic 확정
- 20층마다: Legendary 확정
- 최고 기록 갱신: 추가 보상 상자
```

---

## 🏪 마을 시스템

### 대장간 (Blacksmith)

**기능:**
1. 장비 제작
   - 재료 아이템 소모
   - 골드 소모
   - 제작 성공률 100%

2. 장비 강화
   - 강화석 + 골드 소모
   - 성공률: 100% → 80% → 60% → 40% → 20% (레벨별)
   - 최대 강화 +10
   - 실패시 강화 수치 유지 (아이템 파괴 없음)

3. 장비 분해
   - 장비 → 재료 아이템 변환

### 상점 (Shop)

**판매 품목:**
- 체력 포션 (소/중/대)
- 마나 포션 (소/중/대)
- 강화석 (일반/고급)
- 기본 장비 (Common 등급)

**구매:**
- 플레이어가 얻은 아이템 판매 가능
- 판매가 = 기본가의 50%

---

## ⚔️ 전투 시스템

### 기본 스탯

```
HP: 생명력
MP: 마나 (스킬 사용)
ATK: 공격력
DEF: 방어력
SPD: 이동속도
ASPD: 공격속도
CRIT: 치명타 확률
CRITDMG: 치명타 데미지
```

### 공격 메커니즘

```python
# 데미지 계산
base_damage = attacker.ATK - defender.DEF * 0.5
is_critical = random() < attacker.CRIT
final_damage = base_damage * (attacker.CRITDMG if is_critical else 1.0)

# 스킬 데미지
skill_damage = base_damage * skill.damage_multiplier
```

### 스킬 시스템

**공통 속성:**
- 쿨다운
- 마나 소모
- 데미지 배율
- 범위/타입

**전사 스킬 예시:**
1. **돌진 (Charge)**
   - 쿨다운: 8초 | 마나: 20
   - 전방으로 돌진하며 150% 데미지
   
2. **회전베기 (Whirlwind)**
   - 쿨다운: 12초 | 마나: 35
   - 주변 360도 범위 200% 데미지
   
3. **방패막기 (Shield Block)**
   - 쿨다운: 15초 | 마나: 25
   - 3초간 받는 피해 50% 감소
   
4. **전쟁의함성 (War Cry)**
   - 쿨다운: 20초 | 마나: 40
   - 5초간 공격력 30% 증가

---

## 🎨 UI/UX 설계

### HUD (게임 중 상시 표시)

```
┌─────────────────────────────────────┐
│ HP: ████████░░ 80/100               │
│ MP: ██████░░░░ 60/100               │
│                                      │
│ 스킬 쿨다운 표시: [Q] [W] [E] [R]   │
│                                      │
│ 미니맵           골드: 1,250        │
└─────────────────────────────────────┘
```

### 인벤토리

```
┌──────────────────┐ ┌─────────────────┐
│   장비 슬롯      │ │   가방 (6x4)    │
│  [무기] [투구]   │ │ ┌─┬─┬─┬─┬─┬─┐ │
│  [갑옷]          │ │ │ │ │ │ │ │ │ │
│  [장갑] [반지]   │ │ ├─┼─┼─┼─┼─┼─┤ │
│  [부츠]          │ │ │ │ │ │ │ │ │ │
└──────────────────┘ └─────────────────┘
```

---

## 📊 진행도 및 세이브 시스템

### 저장 데이터

```json
{
  "player": {
    "name": "Hero",
    "class": "Warrior",
    "level": 15,
    "exp": 2500,
    "stats": {...},
    "equipment": {...},
    "inventory": [...]
  },
  "progress": {
    "highest_babel_floor": 23,
    "completed_dungeons": 47,
    "total_playtime": 7200
  },
  "unlocks": {
    "dungeon_difficulties": ["Easy", "Normal", "Hard"],
    "recipes": [...]
  }
}
```

---

## 🎮 카메라 시스템 (디아블로 스타일)

### 카메라 설정

```
- 시점: Isometric (쿼터뷰)
- 각도: 45도 하향
- 거리: 플레이어로부터 10 유닛
- 따라가기: 부드러운 추적 (Lerp)
- 회전: 고정 (회전 불가)
```

### 카메라 움직임

```csharp
// 부드러운 카메라 추적
camera_target = player.position + offset
camera.position = Lerp(camera.position, camera_target, smoothSpeed)
```

---

## 🔊 사운드 설계

### 필요 사운드

**UI:**
- 버튼 클릭
- 아이템 획득
- 레벨업
- 퀘스트 완료

**전투:**
- 각 직업별 기본공격 소리
- 스킬 시전 소리
- 피격 소리
- 몬스터 사망 소리

**배경음악:**
- 마을 BGM (평화로운)
- 던전 BGM (긴장감)
- 바벨탑 BGM (웅장함)
- 보스전 BGM (격렬함)

---

## 🎯 개발 우선순위

### Phase 1: 핵심 시스템 (1-2주)
- [x] 게임 설계 문서
- [ ] 캐릭터 이동 및 조작
- [ ] 기본 공격 시스템
- [ ] 몬스터 AI (기본)
- [ ] 충돌 및 전투 로직

### Phase 2: 스킬 시스템 (1주)
- [ ] 스킬 프레임워크
- [ ] 4개 직업별 스킬 구현
- [ ] 쿨다운 및 마나 시스템
- [ ] 스킬 이펙트

### Phase 3: 던전 시스템 (1-2주)
- [ ] 랜덤 맵 생성 알고리즘
- [ ] 몬스터 스폰 시스템
- [ ] 아이템 드랍 시스템
- [ ] 던전 입장/퇴장

### Phase 4: 바벨탑 시스템 (1주)
- [ ] 층별 시스템
- [ ] 타이머 및 난이도 조절
- [ ] 보스 패턴
- [ ] 기록 시스템

### Phase 5: 마을 시스템 (1주)
- [ ] 대장간 UI 및 로직
- [ ] 상점 UI 및 로직
- [ ] 제작/강화 시스템
- [ ] 경제 밸런싱

### Phase 6: 폴리싱 (1주)
- [ ] UI/UX 개선
- [ ] 사운드 추가
- [ ] 이펙트 강화
- [ ] 밸런스 조정
- [ ] 버그 수정

---

## 📈 밸런스 설계

### 레벨 곡선

```python
# 레벨업 필요 경험치
exp_required = 100 * level^1.5

# 몬스터 경험치 제공량
monster_exp = 10 * monster_level^1.2
```

### 골드 획득

- 몬스터 처치: 5-20 골드
- 던전 클리어: 500-1000 골드
- 바벨탑 층 클리어: 100 * floor 골드

### 장비 제작 비용

| 등급 | 재료 | 골드 비용 |
|------|------|-----------|
| Common | 3개 | 100 |
| Rare | 5개 | 500 |
| Epic | 8개 | 2,000 |
| Legendary | 12개 | 10,000 |

---

## 🐛 알려진 이슈 및 해결 방안

### 예상 기술적 과제

1. **랜덤 던전 생성 성능**
   - 해결: 절차적 생성 알고리즘 최적화, 코루틴 사용

2. **다수의 적 처리 시 프레임 드롭**
   - 해결: Object Pooling, 화면 밖 적 비활성화

3. **저장/로드 시스템**
   - 해결: JSON 직렬화, PlayerPrefs 또는 파일 시스템

4. **스킬 이펙트 관리**
   - 해결: Particle System, Sprite Animation

---

## 📝 참고 자료

- 디아블로 시리즈 (게임플레이 참고)
- Hades (전투 및 진행 시스템)
- Enter the Gungeon (랜덤 던전 생성)
- 업로드된 픽셀 아트 에셋 (25개)

---

**문서 버전:** 1.0  
**최종 수정일:** 2025-11-09  
**작성자:** Development Team
